!function(){"use strict";function e(e,t,n,o){return new(n||(n=Promise))(function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})}function t(e,t){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}"function"==typeof SuppressedError&&SuppressedError;var n,o=function(){function e(){}return e.createIFrame=function(e){var t=document.createElement("iframe");return t.title="Rocketfuel",t.style.display="none",t.style.backgroundColor="transparent",t.style.border="0",t.style.width="410px",t.src=e,t},e.showOverlay=function(e){if(this.iframe)this.iframe.src=e;else{this.iframe=this.createIFrame(e);var t=function(){var e=0,t=0,n=0,o=0,r=document.createElement("div"),i=document.createElement("div");function s(i){(i=i||window.event).preventDefault(),e=n-i.clientX,t=o-i.clientY,n=i.clientX,o=i.clientY,r.style.top=r.offsetTop-t+"px",r.style.left=r.offsetLeft-e+"px"}function a(){document.onmouseup=null,document.onmousemove=null}return r.id="iframeWrapper",i.id="iframeWrapperHeader",r.style.cssText="width: 365px; position: fixed; z-index: 2147483647; top: 10px; right: 55px;",i.style.cssText="padding: 3px;cursor: move;position: absolute;width: 387px;height: 2px;left: 10px;",r.onmousedown=function(e){(e=e||window.event).preventDefault(),n=e.clientX,o=e.clientY,document.onmouseup=a,document.onmousemove=s},r.appendChild(i),r}();this.iframe.style.display="block",this.iframe.style.height="800px",this.iframe.style.border="1px solid #dddddd",this.iframe.style.borderRadius="8px",t.appendChild(this.iframe),document.body.appendChild(t)}},e}(),r={feature:"PAYIN",style:"default",containerStyle:"default",containerId:"default"},i={prod:"https://payments.rocketfuel.inc/select-currency",qa:"https://qa-payment.rfdemo.co/select-currency",preprod:"https://preprod-payment.rocketdemo.net/select-currency",sandbox:"https://payments-sandbox.rocketfuelblockchain.com/select-currency"},s={prod:"http://localhost:3000",qa:"http://localhost:3000",preprod:"http://localhost:3000",sandbox:"http://localhost:3000"},a="sdk-buttons-container",c=function(){function n(e){var t;this.rkflToken=null,this.clientId=e.clientId,this.domain=(t=e.environment,console.log("env --- ",t),i[t]),console.log(this.domain),this.initialize()}return n.prototype.handleMessage=function(e){var t=e.data;console.log("Received from iframe:",t)},n.prototype.initialize=function(){window.addEventListener("message",this.handleMessage)},n.prototype.openRedirect=function(n){return e(this,void 0,void 0,function(){var e;return t(this,function(t){return e="".concat(this.domain,"/").concat(n),window.open(e,"_blank"),[2]})})},n.prototype.openIframe=function(n){return e(this,void 0,void 0,function(){var e;return t(this,function(t){return e="".concat(this.domain,"/").concat(n),o.showOverlay(e),[2]})})},n}();function u(o){return e(this,arguments,void 0,function(e,o,r,i){return void 0===o&&(o=!1),t(this,function(t){try{n=new c({clientId:e,environment:i}),o?n.openRedirect(r):n.openIframe(r)}catch(e){console.error("Failed to place order",e)}return[2]})})}var l,d=function(){function n(e,t){this.appUrl=s[t],this.clientId=e}return n.prototype.initialize=function(){o.showOverlay(this.appUrl),this.eventListnerConcodium()},n.prototype.eventListnerConcodium=function(){var n=this;window.addEventListener("message",function(o){return e(n,void 0,void 0,function(){var e,n,r,i,s;return t(this,function(t){switch(t.label){case 0:return"request_concordium"!==o.data.type?[3,5]:(n=null===window||void 0===window?void 0:window.concordium)?(e=void 0,[4,n.getMostRecentlySelectedAccount()]):[3,4];case 1:return(e=t.sent())?[3,3]:[4,n.connect()];case 2:e=t.sent(),t.label=3;case 3:return o.source.postMessage({type:"concordium_response",message:e},o.origin),[3,5];case 4:o.source.postMessage({type:"concordium_response",message:{error:"Provider not found"}},o.origin),t.label=5;case 5:return"concordium_requestVerifiablePresentation"===o.data.type&&(n=null===window||void 0===window?void 0:window.concordium)&&(r=o.data.payload,i=r.statement,s=r.challenge,n.requestVerifiablePresentation(s,i).then(function(e){o.source.postMessage({type:"concordium_requestVerifiablePresentation_response",message:"verified"},o.origin)}).catch(function(e){o.source.postMessage({type:"concordium_requestVerifiablePresentation_error",error:e},o.origin)})),[2]}})})})},n}(),p=function(){function n(e){this.redirect=!1,this.payNowButton=null,this.clientId=e.clientId,this.buttons=0===e.plugins.length?[r]:e.plugins,this.redirect=e.redirect||!1,this.enviornment=e.environment||"prod",this.uuid=""}return n.prototype.init=function(){var n=this;if(this.buttons.find(function(e){return e.feature===r.feature})){if(!this.clientId)return void console.error("Client ID, Client Secret, and Merchant Id are required")}else if(!this.clientId)return void console.error("Client ID is required");this.buttons.forEach(function(o){var i,s,c=document.createElement("button");switch(c.style.minWidth="250px",c.style.margin="5px",c.style.padding="8px 16px",c.style.border="1px solid #e0e0e0",c.style.borderRadius="999px",c.style.backgroundColor="white",c.style.display="flex",c.style.alignItems="center",c.style.gap="8px",c.style.fontFamily="sans-serif",c.style.fontSize="14px",c.style.color="#1a1a1a",c.style.cursor="pointer",c.style.boxShadow="0 0 0 1px rgba(0,0,0,0.05)",o.feature){case r.feature:c.innerHTML='<img src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-30,h-30,fo-auto,q-50" alt=""> Pay with Cryto Currency',c.disabled=!0,c.style.opacity="0.4",n.payNowButton=c;var p=document.getElementById(o.containerId||a);if(!p)return void console.error("Container not found.");c.onclick=function(){return e(n,void 0,void 0,function(){var e;return t(this,function(t){switch(t.label){case 0:if(!this.uuid)return console.warn("Cart data is not prepared"),[2];this.setLoadingState(!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,u(this.clientId,this.redirect,this.uuid,this.enviornment)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),console.error("Error during order placement:",e),[3,5];case 4:return this.setLoadingState(!1),[7];case 5:return[2]}})})},p.appendChild(c);break;case"AGE_VERIFICATION":c.innerHTML='<img src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-30,h-30,fo-auto,q-50" alt=""> Verification via Rocketfuel',c.onclick=function(){return n.ageVerification(n.enviornment)};var f=document.getElementById(o.containerId||a);if(!f)return void console.error("Container not found.");i=n.clientId,s=n.enviornment,l=new d(i,s),f.appendChild(c);break;default:return void console.warn("Unknown button: ".concat(o))}})},n.prototype.prepareOrder=function(e){this.uuid=e,this.payNowButton&&(this.payNowButton.disabled=!1,this.payNowButton.style.opacity="1")},n.prototype.setLoadingState=function(e){this.payNowButton&&(e?(this.payNowButton.disabled=!0,this.payNowButton.innerText="Processing..."):(this.payNowButton.disabled=!1,this.payNowButton.innerText="Pay Now"))},n.prototype.ageVerification=function(e){console.log(e),l.initialize()},n}();window.RkflPlugin=p}();
