/*! @rocketfuel/client v0.0.1 | (c) Rocketfuel | MIT License */
!function(){"use strict";function e(e,t,i,n){return new(i||(i=Promise))(function(o,r){function s(e){try{a(n.next(e))}catch(e){r(e)}}function d(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,d)}a((n=n.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;const t={feature:"PAYIN",style:"default",containerStyle:"default",containerId:"default"},i="AGE_VERIFICATION",n={prod:"https://payments.rocketfuel.inc/select-currency",qa:"https://qa-payment.rfdemo.co/select-currency",preprod:"https://preprod-payment.rocketdemo.net/select-currency",sandbox:"https://payments-sandbox.rocketfuelblockchain.com/select-currency"},o={prod:"https://rocketfuel-ccd.netlify.app",qa:"https://rocketfuel-ccd.netlify.app",preprod:"https://rocketfuel-ccd.netlify.app",sandbox:"https://rocketfuel-ccd.netlify.app"},r="sdk-buttons-container",s="CLOSE_MODAL";class d{static createIFrame(e){const t=document.createElement("iframe");return t.title="Rocketfuel",t.style.display="none",t.style.backgroundColor="transparent",t.style.border="0",t.style.width="100%",t.style.overflowY="auto",t.src=e,t}static showOverlay(e,t){if(this.iframe)return void(this.iframe.src=e);this.iframe=this.createIFrame(e);const n=function(e){const t=window.innerWidth<=768||/Mobi|Android/i.test(navigator.userAgent),n=document.createElement("div"),o=document.createElement("div");n.id="iframeWrapper",o.id="iframeWrapperHeader",n.style.cssText=e===i?"\n      position: fixed;\n      z-index: 2147483647;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      width: 450px;\n      height: 700px;\n      background: white;\n      overflow: hidden;\n      box-shadow: 0 0 10px rgba(0,0,0,0.15);\n      border-radius: 8px;\n    ":"\n      position: fixed;\n      z-index: 2147483647;\n      top: 10%;\n      right: 2%;\n      width: 450px;\n      height: 800px;\n      background: white;\n      overflow: hidden;\n      box-shadow: 0 0 10px rgba(0,0,0,0.15);\n      border-radius: 8px;\n    ",o.style.cssText="\n  height: 4px;\n  width: 40%;\n  cursor: move;\n  position: absolute;\n  background: #cecece;\n  top: 0;\n  left: 30%;\n  transform: translateY(0);\n  transition: all 0.3s ease;\n  border-radius: 4px;\n",o.title="Drag to move",o.onmouseenter=()=>{t||(o.style.height="14px",o.style.background="#cecece")},o.onmouseup=()=>{t||(o.style.height="4px",o.style.background="#cecece"),l()},t?n.style.cssText="\n    position: fixed;\n    z-index: 2147483647;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border: none;\n    background: white;\n  ":o.onmousedown=function(e){(e=e||window.event).preventDefault(),d=e.clientX,a=e.clientY,document.onmouseup=l,document.onmousemove=c},n.appendChild(o);let r=0,s=0,d=0,a=0;function c(e){(e=e||window.event).preventDefault(),r=d-e.clientX,s=a-e.clientY,d=e.clientX,a=e.clientY,n.style.top=n.offsetTop-s+"px",n.style.left=n.offsetLeft-r+"px"}function l(){document.onmouseup=null,document.onmousemove=null}return n}(t);this.wrapper=n,t===i&&(this.backdrop=document.createElement("div"),this.backdrop.style.backgroundColor="#000000",this.backdrop.style.position="fixed",this.backdrop.style.width="100%",this.backdrop.style.height="100%",this.backdrop.style.top="0",this.backdrop.style.bottom="0",this.backdrop.style.left="0",this.backdrop.style.right="0",this.backdrop.style.zIndex="2147483645",this.backdrop.style.opacity="0.6",this.backdrop.id="backdrop-age-verification"),this.backdrop&&document.body.appendChild(this.backdrop),this.iframe.style.display="block",this.iframe.style.minHeight="100%",this.iframe.style.border="1px solid #dddddd",this.iframe.style.borderRadius="8px",this.iframe.style.background="#F8F8F8";const o=document.createElement("div");o.id="rkfl-loader-overlay",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.border="1px solid #dddddd",o.style.borderRadius="8px",o.style.backgroundColor="#F8F8F8",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",o.style.zIndex="9998";const r=document.createElement("img");r.src="https://ik.imagekit.io/rocketfuel/icons/Ripple%20loading%20animation.gif",r.alt="Loading",r.style.transform="translate(-50%, -50%)",r.style.position="absolute",r.style.top="50%",r.style.left="52%",this.iframe.addEventListener("load",()=>{var e,t;const i=window.location.origin;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({type:"parent_origin",origin:i},"*"),o.remove()}),this.backdrop&&document.body.appendChild(this.backdrop),o.appendChild(r),n.appendChild(this.iframe),n.appendChild(o),document.body.appendChild(n)}static closeIframe(){this.wrapper&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper),this.backdrop&&this.backdrop.parentNode&&this.backdrop.parentNode.removeChild(this.backdrop),this.iframe=null,this.wrapper=null}}d.iframe=null,d.wrapper=null,d.backdrop=null;class a{constructor(e,t,i){this.appUrl=o[t],this.clientId=e,this.redirect=i}initialize(){this.redirect?this.openRedirect(`${this.appUrl}?clientId=${this.clientId}`):(d.showOverlay(`${this.appUrl}?clientId=${this.clientId}`,i),this.eventListnerConcodium())}openRedirect(e){window.open(e,"_blank")}eventListnerConcodium(){window.addEventListener("message",t=>e(this,void 0,void 0,function*(){var e,i,n;if("request_connected_account"===t.data.type){const e=null===window||void 0===window?void 0:window.concordium;if(e){let i;i=yield e.getMostRecentlySelectedAccount(),t.source.postMessage({type:"concordium_response",message:i||null},t.origin)}else t.source.postMessage({type:"concordium_response",message:{error:"Provider not found"}},t.origin)}if("request_concordium"===t.data.type){const e=null===window||void 0===window?void 0:window.concordium;if(e){let i;i=yield e.getMostRecentlySelectedAccount(),i||(i=yield e.connect()),t.source.postMessage({type:"concordium_response",message:i},t.origin)}else t.source.postMessage({type:"concordium_response",message:{error:"Provider not found"}},t.origin)}if("concordium_requestVerifiablePresentation"===t.data.type){const e=null===window||void 0===window?void 0:window.concordium;if(e){const{statement:i,challenge:n}=t.data.payload;e.requestVerifiablePresentation(n,i).then(e=>{t.source.postMessage({type:"concordium_requestVerifiablePresentation_response",message:"verified",data:e},t.origin)}).catch(e=>{t.source.postMessage({type:"concordium_requestVerifiablePresentation_error",error:e},t.origin)})}}"accountDisconnected"===(null===(e=t.data)||void 0===e?void 0:e.eventType)&&(null===(n=null===(i=d.iframe)||void 0===i?void 0:i.contentWindow)||void 0===n||n.postMessage("concordium_disconnected",d.iframe.src))}))}}let c;const l=()=>{if(!c)throw new Error("SDK not initialized properly");c.initialize()};class p{constructor(e){var t;this.rkflToken=null,this.success_event="rocketfuel_result_ok",this.clientId=e.clientId,this.domain=(t=e.environment,n[t]),this.initialize()}handleMessage(e){const t=e.data;if(t.type===this.success_event&&1===t.paymentCompleted){const e=setTimeout(()=>{d.closeIframe(),null!=e||clearTimeout(e)},5e3)}}initialize(){window.addEventListener("message",this.handleMessage)}openRedirect(t){return e(this,void 0,void 0,function*(){const e=`${this.domain}/${t}`;window.open(e,"_blank")})}openIframe(i){return e(this,void 0,void 0,function*(){const e=`${this.domain}/${i}`;d.showOverlay(e,t.feature)})}}let u;window.RkflPlugin=class{constructor(e){this.redirect=!1,this.payNowButton=null,this.innerHtmlPay='<img src="https://ik.imagekit.io/rocketfuel/icons/rocketfuel-circular.svg?tr=w-30,h-30,fo-auto,q-50" alt="" style="width: 30px; height:30px;"> Pay with Cryto Currency',this.innerHtmlVerify='<img src="https://ik.imagekit.io/rocketfuel/icons/rocketfuel-circular.svg?tr=w-30,h-30,fo-auto,q-50" alt="" style="width: 30px; height:30px;"> Verification via Rocketfuel',this.innerHtmlPayLoading='<img src="https://ik.imagekit.io/rocketfuel/icons/rocketfuel-circular.svg?tr=w-30,h-30,fo-auto,q-50" alt="" style="width: 30px; height:30px;"> Processing...',e.environment,this.clientId=e.clientId,this.buttons=0===e.plugins.length?[t]:e.plugins,this.redirect=e.redirect||!1,this.enviornment=e.environment||"prod",this.uuid=""}init(){if(this.buttons.find(e=>e.feature===t.feature)){if(!this.clientId)return void console.error("Client ID is required")}else if(!this.clientId)return void console.error("Client ID is required");this.buttons.forEach(n=>{const o=document.createElement("button");switch(o.style.minWidth="250px",o.style.margin="5px",o.style.padding="8px 16px",o.style.border="1px solid #e0e0e0",o.style.borderRadius="999px",o.style.backgroundColor="white",o.style.display="flex",o.style.alignItems="center",o.style.gap="8px",o.style.fontFamily="sans-serif",o.style.fontSize="14px",o.style.color="#1a1a1a",o.style.cursor="pointer",o.style.boxShadow="0 0 0 1px rgba(0,0,0,0.05)",n.feature){case t.feature:o.innerHTML=this.innerHtmlPay,o.disabled=!0,o.style.opacity="0.4",this.payNowButton=o,o.id="#pay";const y=document.getElementById(n.containerId||r);if(!y)return void console.error("Container not found.");o.onclick=()=>e(this,void 0,void 0,function*(){if(!d.iframe)if(this.uuid){this.setLoadingState(!0);try{yield function(t){return e(this,arguments,void 0,function*(e,t=!1,i,n){try{u=new p({clientId:e,environment:n}),t?u.openRedirect(i):u.openIframe(i)}catch(e){console.error("Failed to place order",e)}})}(this.clientId,this.redirect,this.uuid,this.enviornment)}catch(e){console.error("Error during order placement:",e)}finally{this.setLoadingState(!1)}}else console.warn("Cart data is not prepared")}),document.getElementById("#pay")||y.appendChild(o);break;case i:o.innerHTML=this.innerHtmlVerify,o.onclick=()=>this.ageVerification(this.enviornment),o.id="#age";const f=document.getElementById(n.containerId||r);if(!f&&n.inject)return void console.error("Container not found.");s=this.clientId,l=this.enviornment,h=this.redirect,c=new a(s,l,h),(void 0===n.inject||null===n.inject||n.inject)&&f&&!document.getElementById("#age")&&f.appendChild(o);break;default:return void console.warn(`Unknown button: ${n}`)}var s,l,h}),window.addEventListener("message",this.handleMessage)}prepareOrder(e){this.uuid=e,this.payNowButton&&(this.payNowButton.disabled=!1,this.payNowButton.style.opacity="1")}handleMessage(e){e.data.type===s&&d.closeIframe()}setLoadingState(e){this.payNowButton&&(e?(this.payNowButton.disabled=!0,this.payNowButton.innerHTML=this.innerHtmlPayLoading):(this.payNowButton.disabled=!1,this.payNowButton.innerHTML=this.innerHtmlPay))}ageVerification(e){l()}},window.launchAgeVerificationWidget=l}();
