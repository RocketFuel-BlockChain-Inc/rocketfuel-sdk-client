!function(){"use strict";function e(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class t{static createIFrame(e){const t=document.createElement("iframe");return t.title="Rocketfuel",t.style.display="none",t.style.backgroundColor="transparent",t.style.border="0",t.style.width="410px",t.src=e,t}static showOverlay(e,t=!1){if(this.iframe)return void(this.iframe.src=e);this.iframe=this.createIFrame(e);const n=function(){var e=0,t=0,n=0,i=0;let o=document.createElement("div"),r=document.createElement("div");function s(r){(r=r||window.event).preventDefault(),e=n-r.clientX,t=i-r.clientY,n=r.clientX,i=r.clientY,o.style.top=o.offsetTop-t+"px",o.style.left=o.offsetLeft-e+"px"}function a(){document.onmouseup=null,document.onmousemove=null}return o.id="iframeWrapper",r.id="iframeWrapperHeader",o.style.cssText="width: 360px; position: fixed; z-index: 2147483647; top: 10px; right: 55px;",r.style.cssText="padding: 3px;cursor: move;position: absolute;width: 387px;height: 2px;left: 10px;",o.onmousedown=function(e){(e=e||window.event).preventDefault(),n=e.clientX,i=e.clientY,document.onmouseup=a,document.onmousemove=s},o.appendChild(r),o}();this.wrapper=n,this.iframe.style.display="block",this.iframe.style.height="800px",this.iframe.style.border="1px solid #dddddd",this.iframe.style.borderRadius="8px",this.iframe.style.backgroundColor="#F8F8F8";const i=document.createElement("img");if(i.src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-100,h-100,fo-auto",i.alt="Loading",i.style.position="absolute",i.style.top="49%",i.style.left="58%",i.style.transform="translate(-50%, -50%)",i.style.width="100px",i.style.height="100px",i.style.zIndex="9999",i.style.animation="rkfl-pendulum 1s infinite ease-in-out alternate",!document.getElementById("rkfl-spinner-style")){const e=document.createElement("style");e.id="rkfl-spinner-style",e.textContent="\n        @keyframes rkfl-pendulum {\n          0%   { transform: translate(-50%, -50%) rotate(0deg); }\n          50%  { transform: translate(-50%, -50%) rotate(140deg); }\n          100% { transform: translate(-50%, -50%) rotate(0deg); }\n        }\n      ",document.head.appendChild(e)}if(this.iframe.addEventListener("load",()=>{i.remove()}),t){const e=document.createElement("div");e.innerHTML="&times;",e.style.position="absolute",e.style.top="-6px",e.style.right="-37px",e.style.fontSize="30px",e.style.cursor="pointer",e.style.zIndex="10000",e.addEventListener("click",()=>{this.wrapper&&(document.body.removeChild(this.wrapper),this.wrapper=null,this.iframe=null)}),n.appendChild(e)}n.appendChild(this.iframe),n.appendChild(i),document.body.appendChild(n)}static closeIframe(){this.wrapper&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper),this.iframe=null,this.wrapper=null}}t.iframe=null,t.wrapper=null;const n={feature:"PAYIN",style:"default",containerStyle:"default",containerId:"default"},i="AGE_VERIFICATION",o={prod:"https://payments.rocketfuel.inc/select-currency",qa:"https://qa-payment.rfdemo.co/select-currency",preprod:"https://preprod-payment.rocketdemo.net/select-currency",sandbox:"https://payments-sandbox.rocketfuelblockchain.com/select-currency"},r={prod:"http://localhost:3000",qa:"https://rocketfuel-ccd.netlify.app",preprod:"http://localhost:3000",sandbox:"http://localhost:3000"},s="sdk-buttons-container",a="CLOSE_MODAL";class l{constructor(e){var t;this.rkflToken=null,this.success_event="rocketfuel_result_ok",this.clientId=e.clientId,this.domain=(t=e.environment,o[t]),this.initialize()}handleMessage(e){const n=e.data;if(n.type===this.success_event&&1===n.paymentCompleted){const e=setTimeout(()=>{t.closeIframe(),null!=e||clearTimeout(e)},5e3)}}initialize(){window.addEventListener("message",this.handleMessage)}openRedirect(t){return e(this,void 0,void 0,function*(){const e=`${this.domain}/${t}`;window.open(e,"_blank")})}openIframe(n){return e(this,void 0,void 0,function*(){const e=`${this.domain}/${n}`;t.showOverlay(e,!0)})}}let d,c;class p{constructor(e,t,n){this.appUrl=r[t],this.clientId=e,this.redirect=n}initialize(){this.redirect?this.openRedirect(`${this.appUrl}?clientId=${this.clientId}`):(t.showOverlay(this.appUrl,!1),this.eventListnerConcodium(),window.addEventListener("message",this.handleMessage))}handleMessage(e){e.data.type===a&&t.closeIframe()}openRedirect(e){window.open(e,"_blank")}eventListnerConcodium(){window.addEventListener("message",t=>e(this,void 0,void 0,function*(){if("request_concordium"===t.data.type){const e=null===window||void 0===window?void 0:window.concordium;if(e){let n;n=yield e.getMostRecentlySelectedAccount(),n||(n=yield e.connect()),t.source.postMessage({type:"concordium_response",message:n},t.origin)}else t.source.postMessage({type:"concordium_response",message:{error:"Provider not found"}},t.origin)}if("concordium_requestVerifiablePresentation"===t.data.type){const e=null===window||void 0===window?void 0:window.concordium;if(e){const{statement:n,challenge:i}=t.data.payload;e.requestVerifiablePresentation(i,n).then(e=>{t.source.postMessage({type:"concordium_requestVerifiablePresentation_response",message:"verified",data:e},t.origin)}).catch(e=>{t.source.postMessage({type:"concordium_requestVerifiablePresentation_error",error:e},t.origin)})}}}))}}window.RkflPlugin=class{constructor(e){this.redirect=!1,this.payNowButton=null,this.clientId=e.clientId,this.buttons=0===e.plugins.length?[n]:e.plugins,this.redirect=e.redirect||!1,this.enviornment=e.environment||"prod",this.uuid=""}init(){if(this.buttons.find(e=>e.feature===n.feature)){if(!this.clientId)return void console.error("Client ID, Client Secret, and Merchant Id are required")}else if(!this.clientId)return void console.error("Client ID is required");this.buttons.forEach(o=>{const r=document.createElement("button");switch(r.style.minWidth="250px",r.style.margin="5px",r.style.padding="8px 16px",r.style.border="1px solid #e0e0e0",r.style.borderRadius="999px",r.style.backgroundColor="white",r.style.display="flex",r.style.alignItems="center",r.style.gap="8px",r.style.fontFamily="sans-serif",r.style.fontSize="14px",r.style.color="#1a1a1a",r.style.cursor="pointer",r.style.boxShadow="0 0 0 1px rgba(0,0,0,0.05)",o.feature){case n.feature:r.innerHTML='<img src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-30,h-30,fo-auto,q-50" alt=""> Pay with Cryto Currency',r.disabled=!0,r.style.opacity="0.4",this.payNowButton=r,r.id="#pay";const m=document.getElementById(o.containerId||s);if(!m)return void console.error("Container not found.");r.onclick=()=>e(this,void 0,void 0,function*(){if(!t.iframe)if(this.uuid){this.setLoadingState(!0);try{yield function(t){return e(this,arguments,void 0,function*(e,t=!1,n,i){try{d=new l({clientId:e,environment:i}),t?d.openRedirect(n):d.openIframe(n)}catch(e){console.error("Failed to place order",e)}})}(this.clientId,this.redirect,this.uuid,this.enviornment)}catch(e){console.error("Error during order placement:",e)}finally{this.setLoadingState(!1)}}else console.warn("Cart data is not prepared")}),document.getElementById("#pay")||m.appendChild(r);break;case i:r.innerHTML='<img src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-30,h-30,fo-auto,q-50" alt=""> Verification via Rocketfuel',r.onclick=()=>this.ageVerification(this.enviornment),r.id="#age";const f=document.getElementById(o.containerId||s);if(!f)return void console.error("Container not found.");a=this.clientId,u=this.enviornment,h=this.redirect,c=new p(a,u,h),document.getElementById("#age")||f.appendChild(r);break;default:return void console.warn(`Unknown button: ${o}`)}var a,u,h})}prepareOrder(e){this.uuid=e,this.payNowButton&&(this.payNowButton.disabled=!1,this.payNowButton.style.opacity="1")}setLoadingState(e){this.payNowButton&&(e?(this.payNowButton.disabled=!0,this.payNowButton.innerHTML='<img src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-30,h-30,fo-auto,q-50" alt=""> Processing...'):(this.payNowButton.disabled=!1,this.payNowButton.innerHTML='<img src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-30,h-30,fo-auto,q-50" alt=""> Pay with Cryto Currency'))}ageVerification(e){c.initialize()}}}();
