/*! @rocketfuel/client v1.0.0 | (c) Rocketfuel | MIT License */
!function(){"use strict";function e(e,t,i,n){return new(i||(i=Promise))(function(o,r){function s(e){try{d(n.next(e))}catch(e){r(e)}}function a(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,a)}d((n=n.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;const t={feature:"PAYIN",style:"default",containerStyle:"default",containerId:"default"},i="AGE_VERIFICATION",n={prod:"https://payments.rocketfuel.inc/select-currency",qa:"https://qa-payment.rfdemo.co/select-currency",preprod:"https://preprod-payment.rocketdemo.net/select-currency",sandbox:"https://payments-sandbox.rocketfuelblockchain.com/select-currency"},o={prod:"http://localhost:3000",qa:"https://rocketfuel-ccd.netlify.app",preprod:"http://localhost:3000",sandbox:"http://localhost:3000"},r="sdk-buttons-container",s="CLOSE_MODAL";class a{static createIFrame(e){const t=document.createElement("iframe");return t.title="Rocketfuel",t.style.display="none",t.style.backgroundColor="transparent",t.style.border="0",t.style.width="100%",t.src=e,t}static showOverlay(e){if(this.iframe)return void(this.iframe.src=e);this.iframe=this.createIFrame(e);const t=function(){const e=window.innerWidth<=768||/Mobi|Android/i.test(navigator.userAgent),t=document.createElement("div"),i=document.createElement("div");t.id="iframeWrapper",i.id="iframeWrapperHeader",t.style.cssText="\n  position: fixed;\n  z-index: 2147483647;\n  top: 10%;\n  right: 2%;\n  width: 450px;\n  height: 800px;\n  background: white;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  border-radius: 8px;\n  overflow: hidden;\n",i.style.cssText="\n  height: 4px;\n  width: 40%;\n  cursor: move;\n  position: absolute;\n  background: #cecece;\n  top: 0;\n  left: 30%;\n  transform: translateY(0);\n  transition: all 0.3s ease;\n  border-radius: 4px;\n",i.title="Drag to move",i.onmouseenter=()=>{e||(i.style.height="14px",i.style.background="#cecece")},i.onmouseleave=()=>{e||(i.style.height="4px",i.style.background="#cecece"),d()},e?t.style.cssText="\n    position: fixed;\n    z-index: 2147483647;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border: none;\n    background: white;\n  ":i.onmousedown=function(e){(e=e||window.event).preventDefault(),r=e.clientX,s=e.clientY,document.onmouseup=d,document.onmousemove=a},t.appendChild(i);let n=0,o=0,r=0,s=0;function a(e){(e=e||window.event).preventDefault(),n=r-e.clientX,o=s-e.clientY,r=e.clientX,s=e.clientY,t.style.top=t.offsetTop-o+"px",t.style.left=t.offsetLeft-n+"px"}function d(){document.onmouseup=null,document.onmousemove=null}return t}();this.wrapper=t,this.iframe.style.display="block",this.iframe.style.minHeight="100%",this.iframe.style.border="1px solid #dddddd",this.iframe.style.borderRadius="8px",this.iframe.style.background="#F8F8F8";const i=document.createElement("div");i.id="rkfl-loader-overlay",i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.border="1px solid #dddddd",i.style.borderRadius="8px",i.style.backgroundColor="#F8F8F8",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.style.zIndex="9998";const n=document.createElement("img");n.src="https://ik.imagekit.io/rocketfuel/icons/Ripple%20loading%20animation.gif",n.alt="Loading",n.style.transform="translate(-50%, -50%)",n.style.position="absolute",n.style.top="50%",n.style.left="52%",this.iframe.addEventListener("load",()=>{var e,t;const n=window.location.origin;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({type:"parent_origin",origin:n},"*"),i.remove()}),i.appendChild(n),t.appendChild(this.iframe),t.appendChild(i),document.body.appendChild(t)}static closeIframe(){this.wrapper&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper),this.iframe=null,this.wrapper=null}}a.iframe=null,a.wrapper=null;class d{constructor(e,t,i){this.appUrl=o[t],this.clientId=e,this.redirect=i}initialize(){this.redirect?this.openRedirect(`${this.appUrl}?clientId=${this.clientId}`):(a.showOverlay(this.appUrl),this.eventListnerConcodium())}openRedirect(e){window.open(e,"_blank")}eventListnerConcodium(){window.addEventListener("message",t=>e(this,void 0,void 0,function*(){var e,i,n;if("request_connected_account"===t.data.type){const e=null===window||void 0===window?void 0:window.concordium;if(e){let i;i=yield e.getMostRecentlySelectedAccount(),t.source.postMessage({type:"concordium_response",message:i||null},t.origin)}else t.source.postMessage({type:"concordium_response",message:{error:"Provider not found"}},t.origin)}if("request_concordium"===t.data.type){const e=null===window||void 0===window?void 0:window.concordium;if(e){let i;i=yield e.getMostRecentlySelectedAccount(),i||(i=yield e.connect()),t.source.postMessage({type:"concordium_response",message:i},t.origin)}else t.source.postMessage({type:"concordium_response",message:{error:"Provider not found"}},t.origin)}if("concordium_requestVerifiablePresentation"===t.data.type){const e=null===window||void 0===window?void 0:window.concordium;if(e){const{statement:i,challenge:n}=t.data.payload;e.requestVerifiablePresentation(n,i).then(e=>{t.source.postMessage({type:"concordium_requestVerifiablePresentation_response",message:"verified",data:e},t.origin)}).catch(e=>{t.source.postMessage({type:"concordium_requestVerifiablePresentation_error",error:e},t.origin)})}}"accountDisconnected"===(null===(e=t.data)||void 0===e?void 0:e.eventType)&&(null===(n=null===(i=a.iframe)||void 0===i?void 0:i.contentWindow)||void 0===n||n.postMessage("concordium_disconnected",a.iframe.src))}))}}let l;const c=()=>{if(!l)throw new Error("SDK not initialized properly");l.initialize()};class u{constructor(e){var t;this.rkflToken=null,this.success_event="rocketfuel_result_ok",this.clientId=e.clientId,this.domain=(t=e.environment,n[t]),this.initialize()}handleMessage(e){const t=e.data;if(t.type===this.success_event&&1===t.paymentCompleted){const e=setTimeout(()=>{a.closeIframe(),null!=e||clearTimeout(e)},5e3)}}initialize(){window.addEventListener("message",this.handleMessage)}openRedirect(t){return e(this,void 0,void 0,function*(){const e=`${this.domain}/${t}`;window.open(e,"_blank")})}openIframe(t){return e(this,void 0,void 0,function*(){const e=`${this.domain}/${t}`;a.showOverlay(e)})}}let p;window.RkflPlugin=class{constructor(e){this.redirect=!1,this.payNowButton=null,this.innerHtmlPay='<img src="https://ik.imagekit.io/rocketfuel/icons/rocketfuel-circular.svg?tr=w-30,h-30,fo-auto,q-50" alt="" style="width: 30px; height:30px;"> Pay with Cryto Currency',this.innerHtmlVerify='<img src="https://ik.imagekit.io/rocketfuel/icons/rocketfuel-circular.svg?tr=w-30,h-30,fo-auto,q-50" alt="" style="width: 30px; height:30px;"> Verification via Rocketfuel',this.innerHtmlPayLoading='<img src="https://ik.imagekit.io/rocketfuel/icons/rocketfuel-circular.svg?tr=w-30,h-30,fo-auto,q-50" alt="" style="width: 30px; height:30px;"> Processing...',this.clientId=e.clientId,this.buttons=0===e.plugins.length?[t]:e.plugins,this.redirect=e.redirect||!1,this.enviornment=e.environment||"prod",this.uuid=""}init(){if(this.buttons.find(e=>e.feature===t.feature)){if(!this.clientId)return void console.error("Client ID is required")}else if(!this.clientId)return void console.error("Client ID is required");this.buttons.forEach(n=>{const o=document.createElement("button");switch(o.style.minWidth="250px",o.style.margin="5px",o.style.padding="8px 16px",o.style.border="1px solid #e0e0e0",o.style.borderRadius="999px",o.style.backgroundColor="white",o.style.display="flex",o.style.alignItems="center",o.style.gap="8px",o.style.fontFamily="sans-serif",o.style.fontSize="14px",o.style.color="#1a1a1a",o.style.cursor="pointer",o.style.boxShadow="0 0 0 1px rgba(0,0,0,0.05)",n.feature){case t.feature:o.innerHTML=this.innerHtmlPay,o.disabled=!0,o.style.opacity="0.4",this.payNowButton=o,o.id="#pay";const f=document.getElementById(n.containerId||r);if(!f)return void console.error("Container not found.");o.onclick=()=>e(this,void 0,void 0,function*(){if(!a.iframe)if(this.uuid){this.setLoadingState(!0);try{yield function(t){return e(this,arguments,void 0,function*(e,t=!1,i,n){try{p=new u({clientId:e,environment:n}),t?p.openRedirect(i):p.openIframe(i)}catch(e){console.error("Failed to place order",e)}})}(this.clientId,this.redirect,this.uuid,this.enviornment)}catch(e){console.error("Error during order placement:",e)}finally{this.setLoadingState(!1)}}else console.warn("Cart data is not prepared")}),f.appendChild(o);break;case i:o.innerHTML=this.innerHtmlVerify,o.onclick=()=>this.ageVerification(this.enviornment),o.id="#age";const m=document.getElementById(n.containerId||r);if(!m)return void console.error("Container not found.");s=this.clientId,c=this.enviornment,h=this.redirect,l=new d(s,c,h),(void 0===n.inject||null===n.inject||n.inject)&&m.appendChild(o);break;default:return void console.warn(`Unknown button: ${n}`)}var s,c,h}),window.addEventListener("message",this.handleMessage)}prepareOrder(e){this.uuid=e,this.payNowButton&&(this.payNowButton.disabled=!1,this.payNowButton.style.opacity="1")}handleMessage(e){e.data.type===s&&a.closeIframe()}setLoadingState(e){this.payNowButton&&(e?(this.payNowButton.disabled=!0,this.payNowButton.innerHTML=this.innerHtmlPayLoading):(this.payNowButton.disabled=!1,this.payNowButton.innerHTML=this.innerHtmlPay))}ageVerification(e){c()}},window.launchAgeVerificationWidget=c}();
