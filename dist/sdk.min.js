!function(){"use strict";function e(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{d(i.next(e))}catch(e){r(e)}}function a(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}d((i=i.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class t{static createIFrame(e){const t=document.createElement("iframe");return t.title="Rocketfuel",t.style.display="none",t.style.backgroundColor="transparent",t.style.border="0",t.style.width="410px",t.src=e,t}static showOverlay(e){if(this.iframe)return void(this.iframe.src=e);this.iframe=this.createIFrame(e);const t=function(){var e=0,t=0,n=0,i=0;let o=document.createElement("div"),r=document.createElement("div");function s(r){(r=r||window.event).preventDefault(),e=n-r.clientX,t=i-r.clientY,n=r.clientX,i=r.clientY,o.style.top=o.offsetTop-t+"px",o.style.left=o.offsetLeft-e+"px"}function a(){document.onmouseup=null,document.onmousemove=null}return o.id="iframeWrapper",r.id="iframeWrapperHeader",o.style.cssText="width: 365px; position: fixed; z-index: 2147483647; top: 10px; right: 55px;",r.style.cssText="padding: 3px;cursor: move;position: absolute;width: 387px;height: 2px;left: 10px;",o.onmousedown=function(e){(e=e||window.event).preventDefault(),n=e.clientX,i=e.clientY,document.onmouseup=a,document.onmousemove=s},o.appendChild(r),o}();this.wrapper=t,this.iframe.style.display="block",this.iframe.style.height="800px",this.iframe.style.border="1px solid #dddddd",this.iframe.style.borderRadius="8px",t.appendChild(this.iframe),document.body.appendChild(t)}static closeIframe(){this.wrapper&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper),this.iframe=null,this.wrapper=null}}t.iframe=null,t.wrapper=null;const n={feature:"PAYIN",style:"default",containerStyle:"default",containerId:"default"},i="AGE_VERIFICATION",o={prod:"https://payments.rocketfuel.inc/select-currency",qa:"https://qa-payment.rfdemo.co/select-currency",preprod:"https://preprod-payment.rocketdemo.net/select-currency",sandbox:"https://payments-sandbox.rocketfuelblockchain.com/select-currency"},r={prod:"http://localhost:3000",qa:"http://localhost:3000",preprod:"http://localhost:3000",sandbox:"http://localhost:3000"},s="sdk-buttons-container",a="CLOSE_MODAL";class d{constructor(e){var t;this.rkflToken=null,this.clientId=e.clientId,this.domain=(t=e.environment,o[t]),this.initialize()}handleMessage(e){e.data}initialize(){window.addEventListener("message",this.handleMessage)}openRedirect(t){return e(this,void 0,void 0,function*(){const e=`${this.domain}/${t}`;window.open(e,"_blank")})}openIframe(n){return e(this,void 0,void 0,function*(){const e=`${this.domain}/${n}`;t.showOverlay(e)})}}let c,l;class u{constructor(e,t){this.appUrl=r[t],this.clientId=e}initialize(){t.showOverlay(this.appUrl),this.eventListnerConcodium(),window.addEventListener("message",this.handleMessage)}handleMessage(e){e.data.type===a&&t.closeIframe()}eventListnerConcodium(){window.addEventListener("message",t=>e(this,void 0,void 0,function*(){if("request_concordium"===t.data.type){const e=null===window||void 0===window?void 0:window.concordium;if(e){let n;n=yield e.getMostRecentlySelectedAccount(),n||(n=yield e.connect()),t.source.postMessage({type:"concordium_response",message:n},t.origin)}else t.source.postMessage({type:"concordium_response",message:{error:"Provider not found"}},t.origin)}if("concordium_requestVerifiablePresentation"===t.data.type){const e=null===window||void 0===window?void 0:window.concordium;if(e){const{statement:n,challenge:i}=t.data.payload;e.requestVerifiablePresentation(i,n).then(e=>{t.source.postMessage({type:"concordium_requestVerifiablePresentation_response",message:"verified",data:e},t.origin)}).catch(e=>{t.source.postMessage({type:"concordium_requestVerifiablePresentation_error",error:e},t.origin)})}}}))}}window.RkflPlugin=class{constructor(e){this.redirect=!1,this.payNowButton=null,this.clientId=e.clientId,this.buttons=0===e.plugins.length?[n]:e.plugins,this.redirect=e.redirect||!1,this.enviornment=e.environment||"prod",this.uuid=""}init(){if(this.buttons.find(e=>e.feature===n.feature)){if(!this.clientId)return void console.error("Client ID, Client Secret, and Merchant Id are required")}else if(!this.clientId)return void console.error("Client ID is required");this.buttons.forEach(t=>{const o=document.createElement("button");switch(o.style.minWidth="250px",o.style.margin="5px",o.style.padding="8px 16px",o.style.border="1px solid #e0e0e0",o.style.borderRadius="999px",o.style.backgroundColor="white",o.style.display="flex",o.style.alignItems="center",o.style.gap="8px",o.style.fontFamily="sans-serif",o.style.fontSize="14px",o.style.color="#1a1a1a",o.style.cursor="pointer",o.style.boxShadow="0 0 0 1px rgba(0,0,0,0.05)",t.feature){case n.feature:o.innerHTML='<img src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-30,h-30,fo-auto,q-50" alt=""> Pay with Cryto Currency',o.disabled=!0,o.style.opacity="0.4",this.payNowButton=o;const p=document.getElementById(t.containerId||s);if(!p)return void console.error("Container not found.");o.onclick=()=>e(this,void 0,void 0,function*(){if(this.uuid){this.setLoadingState(!0);try{yield function(t){return e(this,arguments,void 0,function*(e,t=!1,n,i){try{c=new d({clientId:e,environment:i}),t?c.openRedirect(n):c.openIframe(n)}catch(e){console.error("Failed to place order",e)}})}(this.clientId,this.redirect,this.uuid,this.enviornment)}catch(e){console.error("Error during order placement:",e)}finally{this.setLoadingState(!1)}}else console.warn("Cart data is not prepared")}),p.appendChild(o);break;case i:o.innerHTML='<img src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-30,h-30,fo-auto,q-50" alt=""> Verification via Rocketfuel',o.onclick=()=>this.ageVerification(this.enviornment);const h=document.getElementById(t.containerId||s);if(!h)return void console.error("Container not found.");r=this.clientId,a=this.enviornment,l=new u(r,a),h.appendChild(o);break;default:return void console.warn(`Unknown button: ${t}`)}var r,a})}prepareOrder(e){this.uuid=e,this.payNowButton&&(this.payNowButton.disabled=!1,this.payNowButton.style.opacity="1")}setLoadingState(e){this.payNowButton&&(e?(this.payNowButton.disabled=!0,this.payNowButton.innerText="Processing..."):(this.payNowButton.disabled=!1,this.payNowButton.innerText="Pay Now"))}ageVerification(e){l.initialize()}}}();
