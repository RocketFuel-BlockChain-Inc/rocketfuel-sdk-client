var RkflPlugin=function(e){"use strict";function t(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((i=i.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class n{static createIFrame(e){const t=document.createElement("iframe");return t.title="Rocketfuel",t.style.display="none",t.style.backgroundColor="transparent",t.style.border="0",t.style.width="410px",t.src=e,t}static showOverlay(e){if(this.iframe)return void(this.iframe.src=e);this.iframe=this.createIFrame(e);const t=function(){var e=0,t=0,n=0,i=0;let o=document.createElement("div"),r=document.createElement("div");function s(r){(r=r||window.event).preventDefault(),e=n-r.clientX,t=i-r.clientY,n=r.clientX,i=r.clientY,o.style.top=o.offsetTop-t+"px",o.style.left=o.offsetLeft-e+"px"}function a(){document.onmouseup=null,document.onmousemove=null}return o.id="iframeWrapper",r.id="iframeWrapperHeader",o.style.cssText="width: 365px; position: fixed; z-index: 2147483647; top: 10px; right: 55px;",r.style.cssText="padding: 3px;cursor: move;position: absolute;width: 387px;height: 2px;left: 10px;",o.onmousedown=function(e){(e=e||window.event).preventDefault(),n=e.clientX,i=e.clientY,document.onmouseup=a,document.onmousemove=s},o.appendChild(r),o}();this.iframe.style.display="block",this.iframe.style.height="800px",this.iframe.style.border="1px solid #dddddd",this.iframe.style.borderRadius="8px",t.appendChild(this.iframe),document.body.appendChild(t)}}const i={feature:"PAYIN",style:"default",containerStyle:"default",containerId:"default"},o={prod:"https://payments.rocketfuel.inc/select-currency",qa:"https://qa-payment.rfdemo.co/select-currency",preprod:"https://preprod-payment.rocketdemo.net/select-currency",sandbox:"https://payments-sandbox.rocketfuelblockchain.com/select-currency"},r={prod:"http://localhost:3000",qa:"http://localhost:3000",preprod:"http://localhost:3000",sandbox:"http://localhost:3000"},s="sdk-buttons-container";class a{constructor(e){var t;this.rkflToken=null,this.clientId=e.clientId,this.domain=(t=e.environment,o[t]),this.initialize()}handleMessage(e){const t=e.data;console.log("Received from iframe:",t)}initialize(){window.addEventListener("message",this.handleMessage)}openRedirect(e){return t(this,void 0,void 0,function*(){const t=`${this.domain}/${e}`;window.open(t,"_blank")})}openIframe(e){return t(this,void 0,void 0,function*(){const t=`${this.domain}/${e}`;n.showOverlay(t)})}}let c,d;class l{constructor(e,t){this.appUrl=r[t],this.clientId=e}initialize(){n.showOverlay(this.appUrl),this.eventListnerConcodium()}eventListnerConcodium(){window.addEventListener("message",e=>t(this,void 0,void 0,function*(){if("request_concordium"===e.data.type){const t=null===window||void 0===window?void 0:window.concordium;if(t){let n;n=yield t.getMostRecentlySelectedAccount(),n||(n=yield t.connect()),e.source.postMessage({type:"concordium_response",message:n},e.origin)}else e.source.postMessage({type:"concordium_response",message:{error:"Provider not found"}},e.origin)}if("concordium_requestVerifiablePresentation"===e.data.type){const t=null===window||void 0===window?void 0:window.concordium;if(t){const{statement:n,challenge:i}=e.data.payload;t.requestVerifiablePresentation(i,n).then(t=>{e.source.postMessage({type:"concordium_requestVerifiablePresentation_response",message:"verified"},e.origin)}).catch(t=>{e.source.postMessage({type:"concordium_requestVerifiablePresentation_error",error:t},e.origin)})}}}))}}class u{constructor(e){this.redirect=!1,this.payNowButton=null,this.clientId=e.clientId,this.buttons=0===e.plugins.length?[i]:e.plugins,this.redirect=e.redirect||!1,this.enviornment=e.environment||"prod",this.uuid=""}init(){if(this.buttons.find(e=>e.feature===i.feature)){if(!this.clientId)return void console.error("Client ID, Client Secret, and Merchant Id are required")}else if(!this.clientId)return void console.error("Client ID is required");this.buttons.forEach(e=>{const n=document.createElement("button");switch(n.style.minWidth="250px",n.style.margin="5px",n.style.padding="8px 16px",n.style.border="1px solid #e0e0e0",n.style.borderRadius="999px",n.style.backgroundColor="white",n.style.display="flex",n.style.alignItems="center",n.style.gap="8px",n.style.fontFamily="sans-serif",n.style.fontSize="14px",n.style.color="#1a1a1a",n.style.cursor="pointer",n.style.boxShadow="0 0 0 1px rgba(0,0,0,0.05)",e.feature){case i.feature:n.innerHTML='<img src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-30,h-30,fo-auto,q-50" alt=""> Pay with Cryto Currency',n.disabled=!0,n.style.opacity="0.4",this.payNowButton=n;const u=document.getElementById(e.containerId||s);if(!u)return void console.error("Container not found.");n.onclick=()=>t(this,void 0,void 0,function*(){if(this.uuid){this.setLoadingState(!0);try{yield function(e){return t(this,arguments,void 0,function*(e,t=!1,n,i){try{c=new a({clientId:e,environment:i}),t?c.openRedirect(n):c.openIframe(n)}catch(e){console.error("Failed to place order",e)}})}(this.clientId,this.redirect,this.uuid,this.enviornment)}catch(e){console.error("Error during order placement:",e)}finally{this.setLoadingState(!1)}}else console.warn("Cart data is not prepared")}),u.appendChild(n);break;case"AGE_VERIFICATION":n.innerHTML='<img src="https://ik.imagekit.io/rocketfuel/icons/button-image.png?tr=w-30,h-30,fo-auto,q-50" alt=""> Verification via Rocketfuel',n.onclick=()=>this.ageVerification(this.enviornment);const p=document.getElementById(e.containerId||s);if(!p)return void console.error("Container not found.");o=this.clientId,r=this.enviornment,d=new l(o,r),p.appendChild(n);break;default:return void console.warn(`Unknown button: ${e}`)}var o,r})}prepareOrder(e){this.uuid=e,this.payNowButton&&(this.payNowButton.disabled=!1,this.payNowButton.style.opacity="1")}setLoadingState(e){this.payNowButton&&(e?(this.payNowButton.disabled=!0,this.payNowButton.innerText="Processing..."):(this.payNowButton.disabled=!1,this.payNowButton.innerText="Pay Now"))}ageVerification(e){d.initialize()}}return window.RkflPlugin=u,e.RkflPlugin=u,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
